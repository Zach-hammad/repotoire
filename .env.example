# Repotoire Environment Configuration
# Copy this file to .env and update values for your environment
# NEVER commit .env to version control!

# =============================================================================
# PostgreSQL Configuration (SaaS Database)
# =============================================================================
POSTGRES_DB=repotoire
POSTGRES_USER=repotoire
POSTGRES_PASSWORD=your-secure-password-here
POSTGRES_PORT=5432

# Database URL for SQLAlchemy/Alembic
# Format: postgresql://user:password@host:port/database
REPOTOIRE_DATABASE_URL=postgresql://repotoire:your-secure-password-here@localhost:5432/repotoire

# =============================================================================
# FalkorDB Configuration (Default Graph Backend)
# =============================================================================
# FalkorDB is a lightweight Redis-based graph database
FALKORDB_REDIS_PORT=6379
FALKORDB_BOLT_PORT=7687

# =============================================================================
# Redis Configuration (Celery Message Broker)
# =============================================================================
REDIS_PORT=6380
CELERY_BROKER_URL=redis://localhost:6380/0
CELERY_RESULT_BACKEND=redis://localhost:6380/1

# =============================================================================
# Neo4j / Graph Database Configuration
# =============================================================================
# For FalkorDB (default):
REPOTOIRE_NEO4J_URI=bolt://localhost:7687
REPOTOIRE_NEO4J_PASSWORD=

# For Neo4j (use --profile neo4j with docker compose):
# REPOTOIRE_NEO4J_URI=bolt://localhost:7688
# REPOTOIRE_NEO4J_PASSWORD=repotoire-dev-password

# Legacy variable names (for backwards compatibility)
NEO4J_URI=bolt://localhost:7688
NEO4J_USER=neo4j
NEO4J_PASSWORD=your-password-here

# Neo4j Connection Pool Settings
NEO4J_MAX_POOL_SIZE=50
NEO4J_CONNECTION_TIMEOUT=30.0
NEO4J_MAX_CONNECTION_LIFETIME=3600
NEO4J_QUERY_TIMEOUT=60.0
NEO4J_ENCRYPTED=false

# =============================================================================
# Neo4j Service Configuration (Optional Profile)
# =============================================================================
NEO4J_HTTP_PORT=7474
NEO4J_BOLT_PORT=7688

# =============================================================================
# Admin Tools Configuration (Optional)
# =============================================================================
# Use --profile tools with docker compose to start admin tools
PGADMIN_EMAIL=admin@repotoire.local
PGADMIN_PASSWORD=admin
PGADMIN_PORT=8080
REDISINSIGHT_PORT=8001

# =============================================================================
# AI/ML Configuration
# =============================================================================
# OpenAI API key for embeddings and auto-fix features
OPENAI_API_KEY=your-api-key-here

# DeepInfra API key for cheap, high-quality Qwen3 embeddings
# Get from: https://deepinfra.com
DEEPINFRA_API_KEY=your-deepinfra-api-key-here

# Embedding backend: "openai", "deepinfra", or "local"
# - openai: High quality ($0.02/1M tokens)
# - deepinfra: Best quality, cheap (~$0.01/1M tokens) - uses Qwen3-Embedding-8B
# - local: Free, no API key needed - uses Qwen3-Embedding-0.6B
REPOTOIRE_EMBEDDING_BACKEND=openai

# =============================================================================
# E2B Sandbox Configuration
# =============================================================================
# E2B API key for secure cloud sandbox execution
# Get from: https://e2b.dev/dashboard
E2B_API_KEY=your-e2b-api-key-here

# Optional sandbox settings
E2B_TIMEOUT_SECONDS=300
E2B_MEMORY_MB=1024
E2B_CPU_COUNT=1

# =============================================================================
# GitHub App Configuration
# =============================================================================
GITHUB_APP_ID=
GITHUB_APP_PRIVATE_KEY=
GITHUB_WEBHOOK_SECRET=

# =============================================================================
# Clerk Authentication
# =============================================================================
# Get these from your Clerk Dashboard: https://dashboard.clerk.com
CLERK_SECRET_KEY=sk_test_xxx
CLERK_PUBLISHABLE_KEY=pk_test_xxx
CLERK_WEBHOOK_SECRET=

# Authorized parties for JWT verification (comma-separated frontend URLs)
CLERK_AUTHORIZED_PARTIES=http://localhost:3000,http://localhost:3001

# Clerk frontend URL for OAuth redirects (typically your Clerk Accounts subdomain)
CLERK_FRONTEND_URL=https://accounts.repotoire.dev

# =============================================================================
# CLI Authentication (REPO-267)
# =============================================================================
# API URL for CLI authentication
REPOTOIRE_API_URL=https://api.repotoire.dev

# Set to true to skip all API auth and tier limit checks in CLI
# Useful for CI/CD environments or local-only usage
REPOTOIRE_OFFLINE=false

# =============================================================================
# CORS Configuration
# =============================================================================
# Allowed origins for cross-origin requests (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:3001

# =============================================================================
# Stripe Billing
# =============================================================================
STRIPE_SECRET_KEY=sk_test_xxx
STRIPE_PUBLISHABLE_KEY=pk_test_xxx
STRIPE_WEBHOOK_SECRET=whsec_xxx

# Stripe Price IDs (create in Stripe Dashboard > Products)
# Base prices are the platform fee, seat prices are per-additional-seat
STRIPE_PRICE_PRO_BASE=price_xxx           # Pro base price ($29/month)
STRIPE_PRICE_PRO_SEAT=price_xxx           # Pro per-seat price ($10/month)
STRIPE_PRICE_ENTERPRISE_BASE=price_xxx    # Enterprise base price ($99/month)
STRIPE_PRICE_ENTERPRISE_SEAT=price_xxx    # Enterprise per-seat price ($25/month)

# Stripe Connect (Marketplace)
# =============================================================================
# Webhook secret for Connect events (account updates, payouts, transfers)
STRIPE_CONNECT_WEBHOOK_SECRET=whsec_xxx
# Frontend URL for Connect onboarding redirects
FRONTEND_URL=http://localhost:3000

# =============================================================================
# Application Settings
# =============================================================================
# Environment: development, staging, production
ENVIRONMENT=development

# Log level: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# Secret key for session encryption (generate with: openssl rand -hex 32)
SECRET_KEY=your-secret-key-here
